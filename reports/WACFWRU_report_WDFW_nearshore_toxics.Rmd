---
title: "A Retrospective Analysis of Mussel Monitoring in the Puget Sound"
author:
  - name: Catherine Wangen
    email: 'cwangen@uw.edu'
    institute: [qerm]
    correspondence: true
  - name: Mark D. Scheuerell
    email: 'scheuerl@uw.edu'
    institute: [wacfwru]
    correspondence: true
institute:
  - qerm: Quantitative Ecology and Resource Management, University of Washington, Seattle, WA
  - wacfwru: U.S. Geological Survey Washington Cooperative Fish and Wildlife Research Unit, School of Aquatic and Fishery Sciences, University of Washington, Seattle, WA
output:
  pdf_document:
    highlight: haddock
    fig_caption: yes
    pandoc_args:
      - '--lua-filter=scholarly-metadata.lua'
      - '--lua-filter=author-info-blocks.lua'
documentclass: article
geometry: margin=1in
linestretch: 1.1
fontsize: 12pt
header-includes:
- \usepackage{lineno}
- \linenumbers
- \usepackage{float}
- \floatplacement{figure}{H}
bibliography: references.bib
csl: aslo.csl
urlcolor: blue
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warnings = FALSE)

## load {knitcitations}
# library("knitcitations")

## clean out any existing .bib files
# cleanbib()

## set pandoc for formatting
options("citation_format" = "pandoc")
```

```{r analysis setup, include = FALSE}
#### Load libraries ####

library(MASS)
library(tidyverse)
library(here)
library(lme4)
library(RLRsim)
library(ggdist)
library(tidyquant)
library(dplyr)
library(knitr)
library(broom.mixed)
library(sjPlot)
library(AICcmodavg)


# set directories
clean_data_dir <- here("data", "clean")
outputs <- here("outputs")

# get excel file name
totals <- "totals_all.csv"

# load dataframe
mussel_df <- read_csv(here(clean_data_dir, totals), show_col_types = FALSE)

#abs of dry value for now (note below)
mussel_df$dry_value <- abs(mussel_df$dry_value)

#as category
mussel_df$year <- as.factor(mussel_df$year)
mussel_df$wria_nr <- as.factor(mussel_df$wria_nr)
mussel_df$lio_areas <- as.factor(mussel_df$lio_areas)

#remove Penn Cove reference samples
mussel_df <- mussel_df[!is.na(mussel_df$fund_source),]
mussel_df <- subset(mussel_df, site_name != "Penn Cove Reference")

#remove samples from outside Puget sound
mussel_df <- subset(mussel_df, longitude > -123.5)

#create analyte dataframes
PA_df <- mussel_df %>%
  filter(mussel_df$analyte == "SumPAHs16")
PA_df <- PA_df[complete.cases(PA_df),]
PB_df <- mussel_df %>%
  filter(mussel_df$analyte == "SumPBDEs11")
PB_df <- PB_df[complete.cases(PB_df),]
PC_df <- mussel_df %>%
  filter(mussel_df$analyte == "SumPCBs2x17")
PC_df <- PC_df[complete.cases(PC_df),]


#create analyte dataframes with low data LIOs removed
short_PC_df <-PC_df %>% filter(str_detect(lio_areas, 
                                          paste(c("Island","San Juan","Strait of Juan de Fuca"), 
                                                collapse = "|"), negate = TRUE))
short_PB_df <-PB_df %>% filter(str_detect(lio_areas, 
                                          paste(c("Island","San Juan","Strait of Juan de Fuca"), 
                                                collapse = "|"), negate = TRUE))
short_PA_df <-PA_df %>% filter(str_detect(lio_areas, 
                                          paste(c("Island","San Juan","Strait of Juan de Fuca"), 
                                                collapse = "|"), negate = TRUE))

```


# Introduction

This report provides a retrospective analysis of data generated by previous mussel monitoring surveys coordinated under Washington Department of Fish and Wildlife's (WDFW) Toxics Biological Obsevation System (TBiOS). We determine how existing contaminant data from historical bay mussels (*Mytilus trossulus*) can be used as a Toxics in the Nearshore Vital Sign indicator. In addition, we assess the predictive ability of existing sampling rate to predict expected contaminant trends. 


# Methods

All materials used to prepare this report can be found in the following GitHub repository: `https://github.com/cwangen/mussel_toxics`.

## Data

Uncontaminated mussels from a local aquaculture source were transplanted to various locations along the Puget Sound shoreline, covering a broad range of upland land-use types from rural to highly urban. Mussels were placed into cages and left to incubate for 49-107 days before they were recovered, and concentrations of several major contaminant classes were measured. Four mussels surveys were performed, with mussels being retrieved in 2013, 2016, 2018, and 2020. Our analysis focuses on polycyclic aromatic hydrocarbons (PAHs), polybrominated diphenyl ethers (PBDEs), and polychlorinated biphenyls(PCBs) due to their significance in both ecosystem and human health.

## Data Analysis

The data used in this analysis originated in the form of an Microsoft Excel file, titled `2013-20MusselCagesPOPsPAHs_Cnty_WRIA_LIO_Coverages.xlsx.` The data included more fields than used in our analysis, and can be found in its entirety in `/mussel_toxics/data/raw/`. The data file was cleaned in order to correct minor inconsistencies and errors, resulting in `/mussel_toxics/data/clean/totals_all.csv`. 

We used the dry weights of toxics found in each sample for analysis. Although the data records also included the concentration of lipids, as well as wet weight, dry weight is the standard for reporting toxicology data. Data summaries include the following

* Tables of dry weights organized by categorical variables;

* Maps of dry weight concentrations;

* Raincloud plots, consisting of a box plot, an approximate probability density, and the individual data points, for each toxin for based upon WRIA and year.

Samples from the original aquaculture source used as reference materials were removed from the analyses, but included in the concentration maps. Samples outside of Puget Sound (east of -123.5 longitude) were also removed from sampling, but remain in map figures. Figures \ref{fig:PAmap}, \ref{fig:PBmap}, and \ref{fig:PCmap} display the concentrations of PAHs, PBDEs, and PCBs over time in mussel samples, respectively. They also shed light on how sampling is inconsistent both spatially and temporally. 


```{r PAmap, fig.cap = "\\label{fig:PAmap}Estimated concentration of PAHs across Puget Sound."}
knitr::include_graphics(here("outputs","PAHmaps_short_legend.pdf"))
```

```{r PBmap, fig.cap = "\\label{fig:PBmap}Estimated concentration of PBDEs across Puget Sound."}
knitr::include_graphics(here("outputs","PBDEmaps.pdf"))
```

```{r PCMap, fig.cap = "\\label{fig:PCmap}Estimated concentration of PCBs across Puget Sound."}
knitr::include_graphics(here(outputs,"PCBmaps.pdf"))
```

```{r rain_PAH_year, , fig.cap = "\\label{fig:rain_PAH_year}Distribution of the log concentration of PAHs across years."}
PA_df %>% 
  ggplot(aes(x = year, y = log10(dry_value))) +
  ggdist::stat_halfeye(adjust = .5, width = .3, .width = 0, justification = -.3, point_colour = NA) + 
  geom_boxplot(width = .1, outlier.shape = NA) +
  ggdist::stat_dots(side = "left", dotsize = .1, justification = 1.1, binwidth = .1)+
  theme(axis.text.x=element_text(angle=270,hjust=1)) +
  xlab("Year") +
  ylab("log10(dry value)")+
  ggtitle("PAHs Across Years")
```

```{r rain_PAH_LIO, , fig.cap = "\\label{fig:rain_PAH_LIO}Distribution of the log concentration of PAHs across LIOs."}
PA_df %>% 
  ggplot(aes(x = lio_areas, y = log10(dry_value))) +
  ggdist::stat_halfeye(adjust = .5, width = .3, .width = 0, justification = -.3, point_colour = NA) + 
  geom_boxplot(width = .1, outlier.shape = NA) +
  ggdist::stat_dots(side = "left", dotsize = .1, justification = 1.1, binwidth = .1)+  theme(axis.text.x=element_text(angle=315,hjust = 0.01)) +
  xlab("LIO Area") +
  ylab("log10(dry value)")+
  ggtitle("PAHs Across LIOs")
```

```{r rain_PBDE_year, , fig.cap = "\\label{fig:rain_PBDE_year}Distribution of the log concentration of PBDEs across years."}
PB_df %>% 
  ggplot(aes(x = year, y = log10(dry_value))) +
  ggdist::stat_halfeye(adjust = .5, width = .3, .width = 0, justification = -.3, point_colour = NA) + 
  geom_boxplot(width = .1, outlier.shape = NA) +
  ggdist::stat_dots(side = "left", dotsize = .1, justification = 1.1, binwidth = .1)+
  theme(axis.text.x=element_text(angle=270,hjust=1)) +
  xlab("Year") +
  ylab("log10(dry value)")+
  ggtitle("PBDEs Across Years")
```

```{r rain_PBDE_LIO, , fig.cap = "\\label{fig:rain_PBDE_LIO}Distribution of the log concentration of PBDEs across LIOs."}
PB_df %>% 
  ggplot(aes(x = lio_areas, y = log10(dry_value))) +
  ggdist::stat_halfeye(adjust = .5, width = .3, .width = 0, justification = -.3, point_colour = NA) + 
  geom_boxplot(width = .1, outlier.shape = NA) +
  ggdist::stat_dots(side = "left", dotsize = .1, justification = 1.1, binwidth = .1)+
   theme(axis.text.x=element_text(angle=315,hjust = 0.01)) +
  xlab("LIO Area") +
  ylab("log10(dry value)")+
  ggtitle("PBDEs Across LIOs")
```

```{r rain_PCB_year, , fig.cap = "\\label{fig:rain_PCB_year}Distribution of the log concentration of PCBs across years."}
PC_df %>% 
  ggplot(aes(x = year, y = log10(dry_value))) +
  ggdist::stat_halfeye(adjust = .5, width = .3, .width = 0, justification = -.3, point_colour = NA) + 
  geom_boxplot(width = .1, outlier.shape = NA) +
  ggdist::stat_dots(side = "left", dotsize = .1, justification = 1.1, binwidth = .1) +
theme(axis.text.x=element_text(angle=270,hjust=1)) +
  xlab("Year") +
  ylab("log10(dry value)")+
ggtitle("PCBs Across Years")
```

```{r rain_PCB_LIO, , fig.cap = "\\label{fig:rain_PCB_LIO}Distribution of the log concentration of PCBs across LIOs."}
PC_df %>% 
  ggplot(aes(x = lio_areas, y = log10(dry_value))) +
  ggdist::stat_halfeye(adjust = .5, width = .3, .width = 0, justification = -.3, point_colour = NA) + 
  geom_boxplot(width = .1, outlier.shape = NA) +
  ggdist::stat_dots(side = "left", dotsize = .1, justification = 1.1, binwidth = .1)+
  theme(axis.text.x=element_text(angle=315,hjust = 0.01)) +
  xlab("LIO Area") +
  ylab("log10(dry value)")+
ggtitle("PCBs Across LIOs")
```


## Statistical modeling

We modeled the dry weight of the analytes found in mussels using a linear mixed model (LMM). These models consist of fixed effects, which remain constant, and random effects that follow a normal distribution and can correspondingly vary by individual, location, etc. We considered the following explanatory variables in our analysis: 

* time mussels spent in water;

* latitude and longitude;

* year (as a fixed factor);

* county;

* LIO;

* WRIA;

* mean percent AU.

Other extraneous variables (IE, funding source) were not used as there is no possible relationship between these and analyte content, though this information could be helpful when we begin to focus on future sampling plans. Exploratory analysis of the data allowed us to remove extraneous factors, while including those we wished to investigate. Models were created for each of the analytes independently, as their nature and distribution should not be assumed to be the same.

Initial model selection occurred by comparing the Akaike Information Criterion (AIC) of all feasible possible models. Models that were unsuitable due to singular fits (overfitting) or violations or model assumptions such as non-normality were removed. The final model was chosen by taking into account AIC, noninfringement of model assumptions, and variables critical to project goals. 

# Results and Discussion

## Data Analysis


<!-- Or here's the PDFs -->

<!-- ```{r PAlios, echo = FALSE, message=FALSE, fig.align='center', fig.cap='I figured these plots are the best to show, and the rest can go in the appendix, or just be referenced in the repo.', out.width='0.75\\linewidth'} -->


<!-- knitr::include_graphics(here(outputs,"PAHs_Over_LIOs.pdf")) -->
<!-- ``` -->

<!-- ```{r PAyears, echo = FALSE, message=FALSE, fig.align='center', fig.cap='I figured these plots are the best to show, and the rest can go in the appendix, or just be referenced in the repo.', out.width='0.75\\linewidth'} -->


<!-- knitr::include_graphics(here(outputs,"PAHs_Over_Years.pdf")) -->
<!-- ``` -->

<!-- ```{r PBlios, echo = FALSE, message=FALSE, fig.align='center', fig.cap='I figured these plots are the best to show, and the rest can go in the appendix, or just be referenced in the repo.', out.width='0.75\\linewidth'} -->


<!-- knitr::include_graphics(here(outputs,"PBDEs_Over_LIOs.pdf")) -->
<!-- ``` -->

<!-- ```{r PByears, echo = FALSE, message=FALSE, fig.align='center', fig.cap='I figured these plots are the best to show, and the rest can go in the appendix, or just be referenced in the repo.', out.width='0.75\\linewidth'} -->


<!-- knitr::include_graphics(here(outputs,"PBDEs_Over_Years.pdf")) -->
<!-- ``` -->

<!-- ```{r PClios, echo = FALSE, message=FALSE, fig.align='center', fig.cap='I figured these plots are the best to show, and the rest can go in the appendix, or just be referenced in the repo.', out.width='0.75\\linewidth'} -->


<!-- knitr::include_graphics(here(outputs,"PCBs_Over_LIOs.pdf")) -->
<!-- ``` -->

<!-- ```{r PCyears, echo = FALSE, message=FALSE, fig.align='center', fig.cap='I figured these plots are the best to show, and the rest can go in the appendix, or just be referenced in the repo.', out.width='0.75\\linewidth'} -->


<!-- knitr::include_graphics(here(outputs,"PCBs_Over_Years.pdf")) -->
<!-- ``` -->

## Modelling

```{r current final model}

#### PAH ####
PA_LMM <- lmer(log(dry_value) ~
                 time +
                 year +
                 mean_is_au +
                 year:lio_areas +
                 (1|longitude),
               data = short_PA_df,
               na.action = "na.fail")

#### PBDEs ####
PB_LMM <- lmer(log(dry_value) ~
              time +
                 year +
                 mean_is_au +
                 year:lio_areas +
                 (1|longitude),
               data = short_PB_df,
               na.action = "na.fail")

#### PCBs ####
PC_LMM <- lmer(log(dry_value) ~
                 time +
                 year +
                 mean_is_au +
                 year:lio_areas +

                 (1|longitude),
               data = short_PC_df,
               na.action = "na.fail")
```


The final model takes the form,

\begin{equation}
D_{a,i} = \alpha_{a,year} + \gamma_{a,year\times LIO}
+ \beta_{a}\text{surface}_{a,i} + \tau_{a}\text{time}_{a,i} + \mu_{a,[LIO:lon]} + \epsilon_{a,i}
\end{equation}


where $D_{a,i}$ is the natural logarithm of the dry weight of analyte $a$ from a sample site $i$, $\alpha_{a,year}$ is the categorical effect of year on analyte $a$, $\gamma_{a,year\times LIO}$ is the interaction effect of year and LIO on analyte $a$, $\beta_{a}$ is the effect of mean percent AU of the nearest watershed region on analyte $a$ from location $i$, $\tau_{a}$ is the effect of the time the mussels remained in the water (which varied by sampling year) at location $i$ for analyte $a$, $\mu_{a,[LIO:lon]}$ is the random effect of longitude nested within LIO on analyte $a$, such that $\mu_{a,[LIO:lon]} \sim \text{N}(0, \sigma_\mu^2)$, and $\epsilon_{a,i}$ is the residual error, which is normally distributed with $\epsilon_{a,i} \sim \text{N}(0, \sigma_\epsilon^2)$. 

## Model diagnostics



```{r PAdiags, fig.dim = c(7,3), fig.cap = "\\label{fig:PAdiags}Model diagnostics for the top ranked model for PAHs."}

#### QQ plots ####
## set plot area
par(mai = c(0.9, 0.9, 0.6, 0.1),
    omi = c(0, 0, 0, 0),
    mfrow = c(1,3), cex.lab = 1.2)

## residuals vs fitted
plot(fitted(PA_LMM), residuals(PA_LMM), las = 1, pch = 1,
     xlab = "Fitted", ylab = "Residuals",
     main = "Residuals vs Fitted")
abline(h=0, lty = "dashed")

## residuals
qqnorm(residuals(PA_LMM), main = "QQ plot (residuals)", las = 1, pch = 1)
qqline(residuals(PA_LMM))

## Random effects
qqnorm(unlist(ranef(PA_LMM)), main = "QQ plot (RE's)", las = 1, pch = 1)
qqline(unlist(ranef(PA_LMM)))
```

```{r PBdiags, fig.dim = c(7,3), fig.cap = "\\label{fig:PBdiags}Model diagnostics for the top ranked model for PBDEs."}

#### QQ plots ####
## set plot area
par(mai = c(0.9, 0.9, 0.6, 0.1),
    omi = c(0, 0, 0, 0),
    mfrow = c(1,3), cex.lab = 1.2)

## residuals vs fitted
plot(fitted(PB_LMM), residuals(PB_LMM), las = 1, pch = 1,
     xlab = "Fitted", ylab = "Residuals",
     main = "Residuals vs Fitted")
abline(h=0, lty = "dashed")

## residuals
qqnorm(residuals(PB_LMM), main = "QQ plot (residuals)", las = 1, pch = 1)
qqline(residuals(PB_LMM))

## Random effects
qqnorm(unlist(ranef(PB_LMM)), main = "QQ plot (RE's)", las = 1, pch = 1)
qqline(unlist(ranef(PB_LMM)))
```

```{r PCdiags, fig.dim = c(7,3), fig.cap = "\\label{fig:PCdiags}Model diagnostics for the top ranked model for PCBs."}

#### QQ plots ####
## set plot area
par(mai = c(0.9, 0.9, 0.6, 0.1),
    omi = c(0, 0, 0, 0),
    mfrow = c(1,3), cex.lab = 1.2)

## residuals vs fitted
plot(fitted(PC_LMM), residuals(PC_LMM), las = 1, pch = 1,
     xlab = "Fitted", ylab = "Residuals",
     main = "Residuals vs Fitted")
abline(h=0, lty = "dashed")

## residuals
qqnorm(residuals(PC_LMM), main = "QQ plot (residuals)", las = 1, pch = 1)
qqline(residuals(PC_LMM))

## Random effects
qqnorm(unlist(ranef(PC_LMM)), main = "QQ plot (RE's)", las = 1, pch = 1)
qqline(unlist(ranef(PC_LMM)))
```


```{r PA AIC table}

PA_liolat <- lmer(log(dry_value) ~
                 time +
                 year +
                 mean_is_au +
                 year:lio_areas +
                 (1|lio_areas/latitude) ,
               data = short_PA_df,
               na.action = "na.fail")

PA_liolon <- lmer(log(dry_value) ~
                 time +
                 year +
                 mean_is_au +
                 year:lio_areas +
                 (1|lio_areas/longitude),
               data = short_PA_df,
               na.action = "na.fail")

PA_lio <- lmer(log(dry_value) ~
                          time +
                          year +
                          mean_is_au +
                          year:lio_areas +
                          (1|lio_areas),
                        data = short_PA_df,
                        na.action = "na.fail")

PA_lat <- lmer(log(dry_value) ~
                       time +
                       year +
                       mean_is_au +
                       year:lio_areas +
                       (1|latitude),
                     data = short_PA_df,
                     na.action = "na.fail")

PA_lon <- lmer(log(dry_value) ~
                       time +
                       year +
                       mean_is_au +
                       year:lio_areas +
                       (1|longitude),
                     data = short_PA_df,
                     na.action = "na.fail")

models <- list(PA_liolat,PA_liolon,PA_lio,PA_lat,PA_lon)
model.names <- c("(1|LIO/latitude)",
                 "(1|LIO/longitude)",
                 "(1|LIO)",
                 "(1|latitude)",
                 "(1|longitude)")

table <- (aictab(cand.set = models, modnames = model.names, second.ord = "FALSE"))
table$Modnames <- substring(table$Modnames,1)
table <- table[c("Modnames","AIC","Delta_AIC")]
colnames(table) <- c("Random Effect of Model","AIC","Delta AIC")

PA_AIC_table <- table

kable(PA_AIC_table)

kable(anova(PA_LMM))

```


```{r PB AIC table}

PB_liolat <- lmer(log(dry_value) ~
                 time +
                 year +
                 mean_is_au +
                 year:lio_areas +
                 (1|lio_areas/latitude) ,
               data = short_PB_df,
               na.action = "na.fail")

PB_liolon <- lmer(log(dry_value) ~
                 time +
                 year +
                 mean_is_au +
                 year:lio_areas +
                 (1|lio_areas/longitude),
               data = short_PB_df,
               na.action = "na.fail")

PB_lio <- lmer(log(dry_value) ~
                          time +
                          year +
                          mean_is_au +
                          year:lio_areas +
                          (1|lio_areas),
                        data = short_PB_df,
                        na.action = "na.fail")

PB_lat <- lmer(log(dry_value) ~
                       time +
                       year +
                       mean_is_au +
                       year:lio_areas +
                       (1|latitude),
                     data = short_PB_df,
                     na.action = "na.fail")

PB_lon <- lmer(log(dry_value) ~
                       time +
                       year +
                       mean_is_au +
                       year:lio_areas +
                       (1|longitude),
                     data = short_PB_df,
                     na.action = "na.fail")

PB_notime <- lmer(log(dry_value) ~
                      # time +
                       year +
                       mean_is_au +
                       year:lio_areas +
                       (1|longitude),
                     data = short_PB_df,
                     na.action = "na.fail")

models <- list(PB_liolat,PB_liolon,PB_lio,PB_lat,PB_lon)
model.names <- c("(1|LIO/latitude)",
                 "(1|LIO/longitude)",
                 "(1|LIO)",
                 "(1|latitude)",
                 "(1|longitude)")

table <- (aictab(cand.set = models, modnames = model.names, second.ord = "FALSE"))
table$Modnames <- substring(table$Modnames,1)
table <- table[c("Modnames","AIC","Delta_AIC")]
colnames(table) <- c("Random Effect of Model","AIC","Delta AIC")

PB_AIC_table <- table

kable(PB_AIC_table)

kable(anova(PB_LMM))

kable(anova(PB_LMM,PB_notime))

```

```{r PC AIC table}

# does not converge, is not best anyway
PC_liolat <- lmer(log(dry_value) ~
                 time +
                 year +
                 mean_is_au +
                 year:lio_areas +
                 (1|lio_areas/latitude) ,
               data = short_PC_df,
               na.action = "na.fail")

PC_liolon <- lmer(log(dry_value) ~
                 time +
                 year +
                 mean_is_au +
                 year:lio_areas +
                 (1|lio_areas/longitude),
               data = short_PC_df,
               na.action = "na.fail")

PC_lio <- lmer(log(dry_value) ~
                          time +
                          year +
                          mean_is_au +
                          year:lio_areas +
                          (1|lio_areas),
                        data = short_PC_df,
                        na.action = "na.fail")

PC_lat <- lmer(log(dry_value) ~
                       time +
                       year +
                       mean_is_au +
                       year:lio_areas +
                       (1|latitude),
                     data = short_PC_df,
                     na.action = "na.fail")

PC_lon <- lmer(log(dry_value) ~
                       time +
                       year +
                       mean_is_au +
                       year:lio_areas +
                       (1|longitude),
                     data = short_PC_df,
                     na.action = "na.fail")


#NOTE THAT LIO/LAT DOES NOT CONVERGE. Which, along with the higher AIC, likely means that RE combo is not good.

models <- list(PC_liolat,PC_liolon,PC_lio,PC_lat,PC_lon)
model.names <- c("(1|LIO/latitude)",
                 "(1|LIO/longitude)",
                 "(1|LIO)",
                 "(1|latitude)",
                 "(1|longitude)")

table <- (aictab(cand.set = models, modnames = model.names, second.ord = "FALSE"))
table$Modnames <- substring(table$Modnames,1)
table <- table[c("Modnames","AIC","Delta_AIC")]
colnames(table) <- c("Random Effect of Model","AIC","Delta AIC")

PC_AIC_table <- table

kable(PC_AIC_table)

kable(anova(PC_LMM))

```


While we decided to fit the same model for each analyte, the parameter estimates are different in each case (REF TABLE HERE). Most notably, in each case the variable with the highest t-value is mean percent AU, indicating that it is the strongest and most significant effect on dry weight. 

-model parameters (this might require a table)


-what we can and can't say

# Toxics in the Nearshore Recommendation

 

# Acknowledgments



\newpage

# References

\setlength{\parindent}{-0.375in}
\setlength{\leftskip}{0.375in}
\setlength{\parskip}{8pt}
\noindent

```{r}
## create ref cited section
# write.bibtex(file = "references.bib")
```

# Appendix

## Parameter Summary Tables

```{r}

kable(tidy(PA_LMM))
kable(tidy(PB_LMM))
kable(tidy(PC_LMM))

```



## Raincloud plots

These also exist as PDFs or could probably exist as individual files/plots etc. 

```{r PAH appendix raincloud plots, message = FALSE, echo = FALSE, eval = FALSE}

#PAH LIO plots
plot_list = list()
for (i in unique(PA_df$wria_nr)){
  wria_subset <- PA_df[PA_df$wria_nr==i,]
  p = wria_subset %>%
    ggplot(aes(x = year, y = log10(dry_value))) +
    ggdist::stat_halfeye(adjust = .5, width = .3, .width = 0, justification = -.3, point_colour = NA) + 
    geom_boxplot(width = .1, outlier.shape = NA) +
    ggdist::stat_dots(side = "left", dotsize = .05, justification = 1.1, binwidth = .1) +
   ggtitle(paste("PAHs - WRIA #",i)) +
   # theme(axis.text.x=element_text(angle=270,hjust=1)) +
    xlab("Year") +
    ylab("log10(dry value)")
  plot_list[[i]] = p
                                }
# I cannot get this to mute the list?
print(plot_list)

```

```{r PBDE appendix raincloud plots, message = FALSE, echo = FALSE, eval = FALSE}


# PBDE LIO plots
plot_list = list()
for (i in unique(PB_df$lio_areas)){
  wria_subset <- PB_df[PB_df$lio_areas==i,]
  p = wria_subset %>%
    ggplot(aes(x = year, y = log10(dry_value))) +
    ggdist::stat_halfeye(adjust = .5, width = .3, .width = 0, justification = -.3, point_colour = NA) + 
    geom_boxplot(width = .1, outlier.shape = NA) +
    ggdist::stat_dots(side = "left", dotsize = .1, justification = 1.1, binwidth = .1) +
    theme(axis.text.x=element_text(angle=270,hjust=1)) +
    xlab("LIO") +
    ylab("log10(dry value)")+
    ggtitle(paste("PBDEs - LIO -",i))
  plot_list[[i]] = p
}

# I cannot get this to mute the list?
print(plot_list)

```

```{r PCB appendix raincloud plots, message = FALSE, echo = FALSE, eval = FALSE}

# PCB LIO plots
plot_list = list()
for (i in unique(PC_df$lio_areas)){
  wria_subset <- PC_df[PC_df$lio_areas==i,]
  p = wria_subset %>%
    ggplot(aes(x = year, y = log10(dry_value))) +
    ggdist::stat_halfeye(adjust = .5, width = .3, .width = 0, justification = -.3, point_colour = NA) + 
    geom_boxplot(width = .1, outlier.shape = NA) +
    ggdist::stat_dots(side = "left", dotsize = .1, justification = 1.1, binwidth = .1) +
    theme(axis.text.x=element_text(angle=270,hjust=1)) +
    xlab("LIO") +
    ylab("log10(dry value)")+
    ggtitle(paste("PCBs - LIO -",i))
  plot_list[[i]] = p
  
}
# I cannot get this to mute the list?
print(plot_list)
# for (i in unique(PC_df$wria_nr)){
#   print(plot_list[[i]])
# }

```

